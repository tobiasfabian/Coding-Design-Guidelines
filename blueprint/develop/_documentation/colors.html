<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="robots" content="noindex, nofollow">
		<title>Colors – Documentation</title>
		<link rel="stylesheet" href="./index.css">
		<style>
			.colors {
				display: grid;
				grid-template-columns: repeat(auto-fill, minmax(20ch, 1fr));
				font: var(--font-label-xsmall);
				gap: 2rem;
			}
			.color {
				display: flex;
				flex-direction: column;
				gap: 1rem;
				text-wrap-style: balance;

				&::before {
					content: '';
					inline-size: 50px;
					border-radius: 50%;
					aspect-ratio: 1 / 1;
					border: 1px solid black;
					background-color: var(--color);
				}
			}
		</style>
	</head>
	<body>
		<main class="m-stack">
			<h1 class="a-heading">Colors</h1>

			<div class="colors">
			</div>
		</main>

		<script>
			(async () => {
				const colorsElement = document.querySelector('.colors');

				async function getAllCSSVariables() {
					const allCSSVars = new Set();

					function processRules(rules) {
						for (const rule of rules) {
							if (rule instanceof CSSStyleRule && rule.style) {
								for (const prop of rule.style) {
									if (prop.startsWith('--color')) {
										allCSSVars.add(prop);
									}
								}
							} else if (rule instanceof CSSImportRule) {
								try {
									processStylesheet(rule.styleSheet);
								} catch (e) {
									console.warn('Cannot access imported stylesheet:', rule.href);
								}
							} else if (rule.cssRules) {
								// Handle nested rules like @media
								processRules(rule.cssRules);
							}
						}
					}

					function processStylesheet(sheet) {
						try {
							if (sheet.cssRules) {
								processRules(sheet.cssRules);
							}
						} catch (e) {
							console.warn('Cannot access stylesheet:', sheet.href);
						}
					}

					for (const sheet of document.styleSheets) {
						processStylesheet(sheet);
					}

					return Array.from(allCSSVars);
				}

				const sortedCssColorVars = await getAllCSSVariables();

				sortedCssColorVars.forEach((colorName) => {
					colorsElement.appendChild(Object.assign(document.createElement('div'), {
						textContent: colorName,
						className: 'color',
						style: `--color: var(${colorName})`
					}))
				});
			})();

		</script>
	</body>
</html>
